<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>All Item</title>

    <!-- Bootstrap core CSS -->
    <link href="./../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <style>
        option:disabled {
            color: #990000;
        }
        
        input {
            text-align: center
        }
    </style>


</head>

<body>
    <!-- Navigation -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="/">MyPage</a>
            <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarResponsive">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownBlog" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Some Apps
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownBlog">
                            <a class="dropdown-item" href="./../app/calculator/main.html">Calculator</a>
                            <a class="dropdown-item" href="./../app/weightconverter/index.html">Weight converter</a>
                            <a class="dropdown-item" href="./../app/namegame/game.html">Name Game</a> </div>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./../about.html">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./../services.html">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./../contact.html">Contact</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownPortfolio" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Portfolio
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownPortfolio">
                            <a class="dropdown-item" href="./../portfolio-1-col.html">1 Column Portfolio</a>
                            <a class="dropdown-item" href="./../portfolio-2-col.html">2 Column Portfolio</a>
                            <a class="dropdown-item" href="./../portfolio-3-col.html">3 Column Portfolio</a>
                            <a class="dropdown-item" href="./../portfolio-4-col.html">4 Column Portfolio</a>
                            <a class="dropdown-item" href="./../portfolio-item.html">Single Portfolio Item</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownBlog" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Blog
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownBlog">
                            <a class="dropdown-item" href="./../blog-home-1.html">Blog Home 1</a>
                            <a class="dropdown-item" href="./../blog-home-2.html">Blog Home 2</a>
                            <a class="dropdown-item" href="./../blog-post.html">Blog Post</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownBlog" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Other Pages
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownBlog">
                            <a class="dropdown-item" href="./../full-width.html">Full Width Page</a>
                            <a class="dropdown-item" href="./../sidebar.html">Sidebar Page</a>
                            <a class="dropdown-item" href="./../faq.html">FAQ</a>
                            <a class="dropdown-item" href="./../404.html">404</a>
                            <a class="dropdown-item" href="./../pricing.html">Pricing Table</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <!-- Navigation End -->

    <!-- Page Content -->
    <div class="container-fluid" style="margin: 20px; padding: 30px">
        <h1 class="my-4 text-center">Welcome to Inventory Section</h1>
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 mb-4">
                <div class="card h-100">
                    <h4 class="card-header text-center">
                        <a href="/inventory/new" style="float:left" class="btn btn-primary btn-reset-table">Add Item</a> Inventory Table : All Item
                        <a href="/inventory/" style="float:right" class="btn btn-primary btn-reset-table">Get Item</a>
                    </h4>
                    <div class="card-body" style="height: 100%;">
                        <table class="table table-dark table-striped" id="productTable">
                            <thead>
                                <tr>
                                    <th>S.N</th>
                                    <th>Product Name</th>
                                    <th>Product Price</th>
                                    <th>Edit</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                <% sn =1 %>
                                    <%products.forEach(product => {%>
                                        <tr>
                                            <td>
                                                <%=sn%>
                                            </td>
                                            <td>
                                                <%=product.name%>
                                            </td>
                                            <td>
                                                <%=product.price%>
                                            </td>
                                            <td> <button class="btn btn-danger btn-delete" data-id="<%=product.id%>">Delete</button> </td>
                                            <td><a class="btndel" href="/inventory/delete/<%=product._id%>">Delete</a></td>
                                        </tr>
                                        <% sn++ %>
                                            <%});%>
                            </tbody>
                            <tfoot></tfoot>
                        </table>
                    </div>
                    <div class="card-footer">
                        <button class="btn btn-primary" type="submit" form="addForm">Finish </button>
                    </div>
                </div>

            </div>

        </div>
    </div>
    <!-- /.container -->
    <!-- Footer -->
    <footer>
        <div class="footer">
            <p class="m-0 text-center text-white">Copyright &copy; Your Website 2019</p>
        </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="./../vendor/jquery/jquery.min.js"></script>
    <script src="./../vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <script>
        $('.btn-delete').on('click', function() {
            deleteBtnEvent($(this));


            // console.log($(this).data('id'));
            // const id = $(this).data('id');
            // $.ajax({
            //     url: '/inventory/delete/' + id,
            //     type: 'delete',
            //     data: $(this).data('id'),
            //     dataType: 'json'
            // }).then(() => {

            // })

        })

        async function deleteBtnEvent(e) {
            try {
                const id = await e.data('id');
                const res = await $.ajax({
                    url: '/inventory/delete/' + id,
                    type: 'delete',
                    data: $(this).data('id'),
                    dataType: 'json',
                    headers: {
                        "Accept": "application/json; charset=utf-8",
                        "Content-Type": "application/json; charset=utf-8"
                    },
                    xhrFields: {
                        withCredentials: true
                    }

                })
                e.closest('tr').remove();
                $('#productTable').hide();
                console.log(e.closest('table'));
                $('#productTable').show();
                updatTable();
            } catch (error) {
                console.log(error);
            }
        }

        async function updatTable() {
            try {
                const tableData = await$('#productTable').html();
                await ('#productTable').empty();
                await ('#productTable').html(tableData);
            } catch (error) {

            }
        }
    </script>

</body>



</html>